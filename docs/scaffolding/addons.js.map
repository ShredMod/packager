{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/addons/gamepad/style.css","webpack:///./src/addons/gamepad/active.png","webpack:///./src/addons/gamepad/close.svg","webpack:///./src/addons/gamepad/cursor.png","webpack:///./src/addons/gamepad/dot.svg","webpack:///./src/addons/gamepad/gamepadlib.js","webpack:///./src/addons/gamepad/index.js","webpack:///./src/addons/gamepad/userscript.js","webpack:///./src/addons/index.js","webpack:///./src/addons/pause.js","webpack:///./src/addons/pointerlock.js","webpack:///./src/addons/special-cloud-behaviors.js","webpack:///./src/addons/unsafe-cloud-behaviors.js","webpack:///./src/common/event-target.js"],"names":["console","window","defaultAxesMappings","arrows","type","high","low","deadZone","wasd","cursor","sensitivity","emptyMapping","transformAndCopyMapping","mapping","warn","copy","Object","assign","button","prepareMappingForExport","prepareAxisMappingForExport","prepareButtonMappingForExport","padWithEmptyMappings","array","length","push","getMovementConfiguration","usedKeys","usesArrows","has","usesWASD","getGamepadId","gamepad","id","index","GamepadData","constructor","gamepadLib","resetMappings","buttonMappings","getDefaultButtonMappings","map","axesMappings","getDefaultAxisMappings","buttons","hints","importedSettings","alreadyUsedKeys","Set","add","possiblePauseKeys","possibleActionKeys","Array","from","filter","i","includes","findKey","keys","key","getPrimaryAction","getSecondaryAction","getPauseKey","getUp","getDown","getRight","getLeft","action1","action2","action3","action4","axes","defaultHints","generated","GamepadLib","EventTarget","gamepads","Map","handleConnect","bind","handleDisconnect","update","animationFrame","currentTime","deltaTime","virtualCursor","x","y","maxX","Infinity","minX","maxY","minY","modified","_editor","connectCallbacks","keysPressedThisFrame","oldKeysPressed","mouseButtonsPressedThisFrame","oldMouseDown","addEventHandlers","addEventListener","removeEventHandlers","removeEventListener","gamepadConnected","size","Promise","resolve","ensureHintsGenerated","getHintsLazily","resetControls","values","e","callback","log","gamepadData","set","requestAnimationFrame","dispatchEvent","CustomEvent","detail","get","delete","cancelAnimationFrame","dispatchKey","pressed","dispatchMouse","down","dispatchMouseMove","updateButton","value","isDown","Math","abs","action","multiplier","speed","time","oldMouseButtonsPressed","max","min","navigator","getGamepads","data","axis","editor","Error","browserHasBrokenGamepadAPI","userAgent","setConsole","n","addStylesheet","css","stylesheet","document","createElement","textContent","head","appendChild","run","scaffolding","options","gamepadUserscript","pointerlock","gamepadUserstyle","_twGetAsset","path","_twAsset0","_twAsset1","_twAsset2","_twAsset3","vm","editingTarget","runtime","once","vmStarted","_steppingInterval","scratchKeyToKey","toLowerCase","charAt","getKeysUsedByProject","allBlocks","getTargetForStage","targets","isOriginal","blocks","result","block","_blocks","opcode","parent","fields","KEY_OPTION","GAMEPAD_CONFIG_MAGIC","findOptionsComment","target","comments","comment","text","parseOptionsComment","lineWithMagic","split","find","endsWith","jsonText","substr","parsed","JSON","parse","isArray","parsedOptions","renderer","width","_xRight","_xLeft","height","_yTop","_yBottom","canvas","virtualCursorElement","hidden","className","src","hideCursorTimeout","hideRealCursor","body","classList","showRealCursor","remove","virtualCursorSetVisible","visible","clearTimeout","setTimeout","virtualCursorHide","virtualCursorSetDown","toggle","virtualCursorSetPosition","CURSOR_SIZE","stageX","stageY","style","transform","getCanvasSize","ResizeObserver","canvasWidth","canvasHeight","resizeObserver","entries","entry","contentRect","observe","rect","getBoundingClientRect","virtualX","virtualY","postMouseData","rectWidth","rectHeight","postIOData","postKeyboardData","handleGamepadButtonDown","handleGamepadButtonUp","handleGamepadMouseDown","handleGamepadMouseUp","handleGamepadMouseMove","deltaX","deltaY","SPEED_MULTIPLIER","zoomMultiplierX","layersRect","stageWidth","zoomMultiplierY","stageHeight","pointerLockMove","_overlays","api","specialCloudBehaviors","unsafeCloudBehaviors","pause","ScaffoldingAddons","STATUS_PROMISE_WAIT","STATUS_DONE","paused","pausedThreadState","WeakMap","audioContextStateChange","setPaused","_paused","then","audioEngine","audioContext","suspend","ioDevices","clock","thread","threads","updateMonitor","pauseState","pauseTime","currentMSecs","status","emit","resume","now","Date","stackFrame","peekStackFrame","executionContext","timer","dt","startTime","ensurePausedThreadIsStillPaused","originalStepThreads","sequencer","stepThreads","call","originalGreenFlag","greenFlag","originalStartHats","startHats","args","apply","originalGetMonitorThreadCount","_getMonitorThreadCount","count","_canvas","mouse","isLocked","movementX","movementY","_clientX","_clientY","_scratchX","_scratchY","contains","stopPropagation","requestPointerLock","pointerLockElement","error","oldStep","_step","ret","SAFE_PROTOCOLS","isSafeURL","url","u","URL","location","href","protocol","shouldAlwaysOpenInNewTab","shouldAlwaysOpenInCurrentTab","openInNewTab","open","openInCurrentTab","SpecialCloudBehaviorsProvider","enable","manager","setVariable","clipboardData","getData","webSocketProvider","providers","setProjectId","initialProjectId","projectId","handleUpdateVariable","name","setUsername","clipboard","writeText","newId","provider","addCloudProvider","addCloudProviderOverride","isPromise","v","jsValueToScratchValue","UnsafeCloudBehaviorsProvider","setEvalValue","setEvalError","evaluateAsync","js","eval","catch","EventTargetShim","_events","event","handler","handlers","fn","CustomEventShim"],"mappings":"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","file":"scaffolding/addons.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/addons/index.js\");\n","module.exports = \".sa-gamepad-container {\\n  margin-right: 0.2rem;\\n}\\n\\n.sa-gamepad-spacer {\\n  display: flex;\\n  width: 100%;\\n  justify-content: flex-end;\\n}\\n\\n.sa-gamepad-popup-outer {\\n  /* above fullscreen */\\n  z-index: 99999;\\n}\\n.sa-gamepad-popup {\\n  box-sizing: border-box;\\n  width: 700px;\\n  max-height: min(800px, 85vh);\\n  height: 100%;\\n  max-width: 85%;\\n  margin: 50px auto;\\n  display: flex;\\n  flex-direction: column;\\n}\\n.sa-gamepad-popup-content {\\n  background-color: white;\\n  padding: 1.5rem 2.25rem;\\n  height: 100%;\\n  overflow-y: auto;\\n}\\n\\n.sa-gamepad-popup [class*=\\\"modal_header-item-title\\\"] {\\n  margin: 0 -20rem 0 0;\\n}\\n\\n.sa-gamepad-cursor {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  z-index: 9999;\\n  user-select: none;\\n  pointer-events: none;\\n  will-change: transform;\\n  image-rendering: optimizeSpeed;\\n  image-rendering: crisp-edges;\\n  image-rendering: pixelated;\\n}\\n.sa-gamepad-cursor-down {\\n  filter: invert(100%);\\n}\\n\\n.sa-gamepad-small .sa-gamepad-container[data-editor-mode=\\\"editor\\\"] {\\n  display: none !important;\\n}\\n\\n.sa-gamepad-hide-cursor {\\n  cursor: none;\\n}\\n\\n.sa-gamepad-browser-support-warning {\\n  font-weight: bold;\\n  margin-bottom: 10px;\\n}\\n\\n.sa-gamepad-store-settings {\\n  display: none;\\n}\\n.sa-gamepad-store-settings > input {\\n  margin-right: 4px;\\n}\\n.sa-gamepad-has-controller .sa-gamepad-store-settings {\\n  display: block;\\n}\\n\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAGCAIAAABvrngfAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAAgSURBVBhXY/z//z8DKmCC0kgAKsQIBhA2FlXEmMXAAAC+2gYLeDM0CAAAAABJRU5ErkJggg==\"","export default \"data:image/svg+xml;base64,PHN2ZyBkYXRhLW5hbWU9IkxheWVyIDEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDcuNDggNy40OCI+PHBhdGggZD0iTTMuNzQgNi40OFYxTTEgMy43NGg1LjQ4IiBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6MnB4Ii8+PC9zdmc+Cg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAGCAIAAABvrngfAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAAVSURBVBhXYyAF/AcDCJsJQpEKGBgAjmQF/WBrfi0AAAAASUVORK5CYII=\"","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4IiBoZWlnaHQ9IjgiIHZpZXdCb3g9IjAgMCAyLjExNyAyLjExNyI+PGNpcmNsZSBjeD0iMS4wNTgiIGN5PSIxLjA1OCIgcj0iMS4wNTgiIGZpbGw9InJlZCIvPjwvc3ZnPgo=\"","import {EventTarget, CustomEvent} from '../../common/event-target';\n\nlet console = window.console;\n\n/*\nMapping types:\n\ntype: \"key\" maps a button to a keyboard key\nAll key names will be interpreted as a KeyboardEvent.key value (https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values)\nhigh: \"KeyName\" is the name of the key to dispatch when a button reads a HIGH value\nlow: \"KeyName\" is the name of the key to dispatch when a button reads a LOW value\ndeadZone: 0.5 controls the minimum value necessary to be read in either + or - to trigger either high or low\nThe high/low distinction is necessary for axes. Buttons will only use high\n\ntype: \"mousedown\" maps a button to control whether the mouse is down or not\ndeadZone: 0.5 controls the minimum value to trigger a mousedown\nbutton: 0, 1, 2, etc. controls which button to press\n\ntype: \"virtual_cursor\" maps a button to control the \"virtual cursor\"\ndeadZone: 0.5 again controls the minimum value to trigger a movement\nsensitivity: 10 controls the speed\nhigh: \"+y\"/\"-y\"/\"+x\"/\"-x\" defines what happens when an axis reads high\nlow: \"+y\"/\"-y\"/\"+x\"/\"-x\" defines what happens when an axis reads low\n+y increases y, -y decreases y, +x increases x, -x decreases x.\n*/\n\nconst defaultAxesMappings = {\n  arrows: [\n    {\n      type: \"key\",\n      high: \"ArrowRight\",\n      low: \"ArrowLeft\",\n      deadZone: 0.5,\n    },\n    {\n      type: \"key\",\n      high: \"ArrowDown\",\n      low: \"ArrowUp\",\n      deadZone: 0.5,\n    },\n  ],\n  wasd: [\n    {\n      type: \"key\",\n      high: \"d\",\n      low: \"a\",\n      deadZone: 0.5,\n    },\n    {\n      type: \"key\",\n      high: \"s\",\n      low: \"w\",\n      deadZone: 0.5,\n    },\n  ],\n  cursor: [\n    {\n      type: \"virtual_cursor\",\n      high: \"+x\",\n      low: \"-x\",\n      sensitivity: 0.6,\n      deadZone: 0.2,\n    },\n    {\n      type: \"virtual_cursor\",\n      high: \"-y\",\n      low: \"+y\",\n      sensitivity: 0.6,\n      deadZone: 0.2,\n    },\n  ],\n};\n\nconst emptyMapping = () => ({\n  type: \"key\",\n  high: null,\n  low: null,\n});\nconst transformAndCopyMapping = (mapping) => {\n  if (typeof mapping !== \"object\" || !mapping) {\n    console.warn(\"invalid mapping\", mapping);\n    return emptyMapping();\n  }\n  const copy = Object.assign({}, mapping);\n  if (copy.type === \"key\") {\n    if (typeof copy.deadZone === \"undefined\") {\n      copy.deadZone = 0.5;\n    }\n    if (typeof copy.high === \"undefined\") {\n      copy.high = \"\";\n    }\n    if (typeof copy.low === \"undefined\") {\n      copy.low = \"\";\n    }\n  } else if (copy.type === \"mousedown\") {\n    if (typeof copy.deadZone === \"undefined\") {\n      copy.deadZone = 0.5;\n    }\n    if (typeof copy.button === \"undefined\") {\n      copy.button = 0;\n    }\n  } else if (copy.type === \"virtual_cursor\") {\n    if (typeof copy.high === \"undefined\") {\n      copy.high = \"\";\n    }\n    if (typeof copy.low === \"undefined\") {\n      copy.low = \"\";\n    }\n    if (typeof copy.sensitivity === \"undefined\") {\n      copy.sensitivity = 10;\n    }\n    if (typeof copy.deadZone === \"undefined\") {\n      copy.deadZone = 0.5;\n    }\n  } else {\n    console.warn(\"unknown mapping type\", copy.type);\n    return emptyMapping();\n  }\n  return copy;\n};\nconst prepareMappingForExport = (mapping) => Object.assign({}, mapping);\nconst prepareAxisMappingForExport = prepareMappingForExport;\nconst prepareButtonMappingForExport = (mapping) => {\n  const copy = prepareMappingForExport(mapping);\n  delete copy.deadZone;\n  delete copy.low;\n  return copy;\n};\n\nconst padWithEmptyMappings = (array, length) => {\n  // Keep adding empty mappings until the list is full\n  while (array.length < length) {\n    array.push(emptyMapping());\n  }\n  // In case the input array is longer than the desired length\n  array.length = length;\n  return array;\n};\n\nconst getMovementConfiguration = (usedKeys) => ({\n  usesArrows:\n    usedKeys.has(\"ArrowUp\") || usedKeys.has(\"ArrowDown\") || usedKeys.has(\"ArrowRight\") || usedKeys.has(\"ArrowLeft\"),\n  usesWASD: (usedKeys.has(\"w\") && usedKeys.has(\"s\")) || (usedKeys.has(\"a\") && usedKeys.has(\"d\")),\n});\n\nconst getGamepadId = (gamepad) => `${gamepad.id} (${gamepad.index})`;\n\nclass GamepadData {\n  /**\n   * @param {Gamepad} gamepad Source Gamepad\n   * @param {GamepadLib} gamepadLib Parent GamepadLib\n   */\n  constructor(gamepad, gamepadLib) {\n    this.gamepad = gamepad;\n    this.gamepadLib = gamepadLib;\n    this.resetMappings();\n  }\n\n  resetMappings() {\n    this.buttonMappings = this.getDefaultButtonMappings().map(transformAndCopyMapping);\n    this.axesMappings = this.getDefaultAxisMappings().map(transformAndCopyMapping);\n  }\n\n  getDefaultButtonMappings() {\n    let buttons;\n    if (this.gamepadLib.hints.importedSettings) {\n      buttons = this.gamepadLib.hints.importedSettings.buttons;\n    } else {\n      const usedKeys = this.gamepadLib.hints.usedKeys;\n      const alreadyUsedKeys = new Set();\n      const { usesArrows, usesWASD } = getMovementConfiguration(usedKeys);\n      if (usesWASD) {\n        alreadyUsedKeys.add(\"w\");\n        alreadyUsedKeys.add(\"a\");\n        alreadyUsedKeys.add(\"s\");\n        alreadyUsedKeys.add(\"d\");\n      }\n      const possiblePauseKeys = [\n        // Restart keys, pause keys, other potentially dangerous keys\n        \"p\",\n        \"q\",\n        \"r\",\n      ];\n      const possibleActionKeys = [\n        \" \",\n        \"Enter\",\n        \"e\",\n        \"f\",\n        \"z\",\n        \"x\",\n        \"c\",\n        ...Array.from(usedKeys).filter((i) => i.length === 1 && !possiblePauseKeys.includes(i)),\n      ];\n\n      const findKey = (keys) => {\n        for (const key of keys) {\n          if (usedKeys.has(key) && !alreadyUsedKeys.has(key)) {\n            alreadyUsedKeys.add(key);\n            return key;\n          }\n        }\n        return null;\n      };\n      const getPrimaryAction = () => {\n        if (usesArrows && usedKeys.has(\"ArrowUp\")) {\n          return \"ArrowUp\";\n        }\n        if (usesWASD && usedKeys.has(\"w\")) {\n          return \"w\";\n        }\n        return findKey(possibleActionKeys);\n      };\n      const getSecondaryAction = () => findKey(possibleActionKeys);\n      const getPauseKey = () => findKey(possiblePauseKeys);\n      const getUp = () => {\n        if (usesArrows || !usesWASD) return \"ArrowUp\";\n        return \"w\";\n      };\n      const getDown = () => {\n        if (usesArrows || !usesWASD) return \"ArrowDown\";\n        return \"s\";\n      };\n      const getRight = () => {\n        if (usesArrows || !usesWASD) return \"ArrowRight\";\n        return \"d\";\n      };\n      const getLeft = () => {\n        if (usesArrows || !usesWASD) return \"ArrowLeft\";\n        return \"a\";\n      };\n\n      const action1 = getPrimaryAction();\n      let action2 = getSecondaryAction();\n      let action3 = getSecondaryAction();\n      let action4 = getSecondaryAction();\n      // When only 1 or 2 action keys are detected, bind the other buttons to the same things.\n      if (action1 && !action2 && !action3 && !action4) {\n        action2 = action1;\n        action3 = action1;\n        action4 = action1;\n      }\n      if (action1 && action2 && !action3 && !action4) {\n        action3 = action1;\n        action4 = action2;\n      }\n\n      // Set indices \"manually\" because we don't evaluate them in order.\n      buttons = [];\n      buttons[0] = {\n        /*\n        Xbox: A\n        SNES-like: B\n        */\n        type: \"key\",\n        high: action1,\n      };\n      buttons[1] = {\n        /*\n        Xbox: B\n        SNES-like: A\n        */\n        type: \"key\",\n        high: action2,\n      };\n      buttons[2] = {\n        /*\n        Xbox: X\n        SNES-like: Y\n        */\n        type: \"key\",\n        high: action3,\n      };\n      buttons[3] = {\n        /*\n        Xbox: Y\n        SNES-like: X\n        */\n        type: \"key\",\n        high: action4,\n      };\n      buttons[4] = {\n        /*\n        Xbox: LB\n        SNES-like: Left trigger\n        */\n        type: \"mousedown\",\n      };\n      buttons[5] = {\n        /*\n        Xbox: RB\n        */\n        type: \"mousedown\",\n      };\n      buttons[6] = {\n        /*\n        Xbox: LT\n        */\n        type: \"mousedown\",\n      };\n      buttons[7] = {\n        /*\n        Xbox: RT\n        SNES-like: Right trigger\n        */\n        type: \"mousedown\",\n      };\n      buttons[9] = {\n        /*\n        Xbox: Menu\n        SNES-like: Start\n        */\n        type: \"key\",\n        high: getPauseKey(),\n      };\n      buttons[8] = {\n        /*\n        Xbox: Change view\n        SNES-like: Select\n        */\n        type: \"key\",\n        high: getPauseKey(),\n      };\n      // Xbox: Left analog press\n      buttons[10] = emptyMapping();\n      // Xbox: Right analog press\n      buttons[11] = emptyMapping();\n      buttons[12] = {\n        /*\n        Xbox: D-pad up\n        */\n        type: \"key\",\n        high: getUp(),\n      };\n      buttons[13] = {\n        /*\n        Xbox: D-pad down\n        */\n        type: \"key\",\n        high: getDown(),\n      };\n      buttons[14] = {\n        /*\n        Xbox: D-pad left\n        */\n        type: \"key\",\n        high: getLeft(),\n      };\n      buttons[15] = {\n        /*\n        Xbox: D-pad right\n        */\n        type: \"key\",\n        high: getRight(),\n      };\n    }\n    return padWithEmptyMappings(buttons, this.gamepad.buttons.length);\n  }\n\n  getDefaultAxisMappings() {\n    let axes = [];\n    if (this.gamepadLib.hints.importedSettings) {\n      axes = this.gamepadLib.hints.importedSettings.axes;\n    } else {\n      // Only return default axis mappings when there are 4 axes, like an xbox controller\n      // If there isn't exactly 4, we can't really predict what the axes mean\n      // Some controllers map the dpad to *both* buttons and axes at the same time, which would cause conflicts.\n      if (this.gamepad.axes.length === 4) {\n        const usedKeys = this.gamepadLib.hints.usedKeys;\n        const { usesArrows, usesWASD } = getMovementConfiguration(usedKeys);\n        if (usesWASD) {\n          axes.push(defaultAxesMappings.wasd[0]);\n          axes.push(defaultAxesMappings.wasd[1]);\n        } else if (usesArrows) {\n          axes.push(defaultAxesMappings.arrows[0]);\n          axes.push(defaultAxesMappings.arrows[1]);\n        } else {\n          axes.push(defaultAxesMappings.cursor[0]);\n          axes.push(defaultAxesMappings.cursor[1]);\n        }\n        axes.push(defaultAxesMappings.cursor[0]);\n        axes.push(defaultAxesMappings.cursor[1]);\n      }\n    }\n    return padWithEmptyMappings(axes, this.gamepad.axes.length);\n  }\n}\n\nconst defaultHints = () => ({\n  usedKeys: new Set(),\n  importedSettings: null,\n  generated: false,\n});\n\nclass GamepadLib extends EventTarget {\n  constructor() {\n    super();\n\n    /** @type {Map<string, GamepadData>} */\n    this.gamepads = new Map();\n\n    this.handleConnect = this.handleConnect.bind(this);\n    this.handleDisconnect = this.handleDisconnect.bind(this);\n    this.update = this.update.bind(this);\n\n    this.animationFrame = null;\n    this.currentTime = null;\n    this.deltaTime = 0;\n\n    this.virtualCursor = {\n      x: 0,\n      y: 0,\n      maxX: Infinity,\n      minX: -Infinity,\n      maxY: Infinity,\n      minY: -Infinity,\n      modified: false,\n    };\n\n    this._editor = null;\n\n    this.connectCallbacks = [];\n\n    this.hints = defaultHints();\n\n    this.keysPressedThisFrame = new Set();\n    this.oldKeysPressed = new Set();\n\n    this.mouseButtonsPressedThisFrame = new Set();\n    this.oldMouseDown = new Set();\n\n    this.addEventHandlers();\n  }\n\n  addEventHandlers() {\n    window.addEventListener(\"gamepadconnected\", this.handleConnect);\n    window.addEventListener(\"gamepaddisconnected\", this.handleDisconnect);\n  }\n\n  removeEventHandlers() {\n    window.removeEventListener(\"gamepadconnected\", this.handleConnect);\n    window.removeEventListener(\"gamepaddisconnected\", this.handleDisconnect);\n  }\n\n  gamepadConnected() {\n    if (this.gamepads.size > 0) {\n      return Promise.resolve();\n    }\n    return new Promise((resolve) => {\n      this.connectCallbacks.push(resolve);\n    });\n  }\n\n  ensureHintsGenerated() {\n    if (this.hints.generated) {\n      return;\n    }\n    if (this.getHintsLazily) {\n      Object.assign(this.hints, this.getHintsLazily());\n    }\n    this.hints.generated = true;\n  }\n\n  resetControls() {\n    this.hints = defaultHints();\n    this.ensureHintsGenerated();\n    for (const gamepad of this.gamepads.values()) {\n      gamepad.resetMappings();\n    }\n  }\n\n  handleConnect(e) {\n    this.ensureHintsGenerated();\n    for (const callback of this.connectCallbacks) {\n      callback();\n    }\n    this.connectCallbacks = [];\n    const gamepad = e.gamepad;\n    const id = getGamepadId(gamepad);\n    console.log(\"connected\", gamepad);\n    const gamepadData = new GamepadData(gamepad, this);\n    this.gamepads.set(id, gamepadData);\n    if (this.animationFrame === null) {\n      this.animationFrame = requestAnimationFrame(this.update);\n    }\n    this.dispatchEvent(new CustomEvent(\"gamepadconnected\", { detail: gamepadData }));\n  }\n\n  handleDisconnect(e) {\n    const gamepad = e.gamepad;\n    const id = getGamepadId(gamepad);\n    console.log(\"disconnected\", gamepad);\n    const gamepadData = this.gamepads.get(id);\n    this.gamepads.delete(id);\n    this.dispatchEvent(new CustomEvent(\"gamepaddisconnected\", { detail: gamepadData }));\n    if (this.gamepads.size === 0) {\n      cancelAnimationFrame(this.animationFrame);\n      this.animationFrame = null;\n      this.currentTime = null;\n    }\n  }\n\n  dispatchKey(key, pressed) {\n    if (pressed) {\n      this.dispatchEvent(new CustomEvent(\"keydown\", { detail: key }));\n    } else {\n      this.dispatchEvent(new CustomEvent(\"keyup\", { detail: key }));\n    }\n  }\n\n  dispatchMouse(button, down) {\n    if (down) {\n      this.dispatchEvent(new CustomEvent(\"mousedown\", { detail: button }));\n    } else {\n      this.dispatchEvent(new CustomEvent(\"mouseup\", { detail: button }));\n    }\n  }\n\n  dispatchMouseMove(x, y) {\n    this.dispatchEvent(new CustomEvent(\"mousemove\", { detail: { x, y } }));\n  }\n\n  updateButton(value, mapping) {\n    if (mapping.type === \"key\") {\n      if (value >= mapping.deadZone) {\n        if (mapping.high) {\n          this.keysPressedThisFrame.add(mapping.high);\n        }\n      } else if (value <= -mapping.deadZone) {\n        if (mapping.low) {\n          this.keysPressedThisFrame.add(mapping.low);\n        }\n      }\n    } else if (mapping.type === \"mousedown\") {\n      const isDown = Math.abs(value) >= mapping.deadZone;\n      if (isDown) {\n        this.mouseButtonsPressedThisFrame.add(mapping.button);\n      }\n    } else if (mapping.type === \"virtual_cursor\") {\n      const deadZone = mapping.deadZone;\n      let action;\n      if (value >= deadZone) action = mapping.high;\n      if (value <= -deadZone) action = mapping.low;\n      if (action) {\n        // an axis value just beyond the deadzone should have a multiplier near 0, a high value should have a multiplier of 1\n        const multiplier = (Math.abs(value) - deadZone) / (1 - deadZone);\n        const speed = multiplier * multiplier * mapping.sensitivity * this.deltaTime;\n        if (action === \"+x\") {\n          this.virtualCursor.x += speed;\n        } else if (action === \"-x\") {\n          this.virtualCursor.x -= speed;\n        } else if (action === \"+y\") {\n          this.virtualCursor.y += speed;\n        } else if (action === \"-y\") {\n          this.virtualCursor.y -= speed;\n        }\n        this.virtualCursor.modified = true;\n      }\n    }\n  }\n\n  update(time) {\n    this.oldKeysPressed = this.keysPressedThisFrame;\n    this.oldMouseButtonsPressed = this.mouseButtonsPressedThisFrame;\n    this.keysPressedThisFrame = new Set();\n    this.mouseButtonsPressedThisFrame = new Set();\n\n    if (this.currentTime === null) {\n      this.deltaTime = 0; // doesn't matter what this is, it's just the first frame\n    } else {\n      this.deltaTime = time - this.currentTime;\n    }\n    this.deltaTime = Math.max(Math.min(this.deltaTime, 1000), 0);\n    this.currentTime = time;\n\n    this.animationFrame = requestAnimationFrame(this.update);\n\n    const gamepads = navigator.getGamepads();\n    for (const gamepad of gamepads) {\n      if (gamepad === null) {\n        continue;\n      }\n\n      const id = getGamepadId(gamepad);\n      const data = this.gamepads.get(id);\n\n      for (let i = 0; i < gamepad.buttons.length; i++) {\n        const button = gamepad.buttons[i];\n        const value = button.value;\n        const mapping = data.buttonMappings[i];\n        this.updateButton(value, mapping);\n      }\n\n      for (let i = 0; i < gamepad.axes.length; i++) {\n        const axis = gamepad.axes[i];\n        const mapping = data.axesMappings[i];\n        this.updateButton(axis, mapping);\n      }\n    }\n\n    if (this._editor) {\n      this._editor.update(gamepads);\n    }\n\n    for (const key of this.keysPressedThisFrame) {\n      if (!this.oldKeysPressed.has(key)) {\n        this.dispatchKey(key, true);\n      }\n    }\n    for (const key of this.oldKeysPressed) {\n      if (!this.keysPressedThisFrame.has(key)) {\n        this.dispatchKey(key, false);\n      }\n    }\n\n    for (const button of this.mouseButtonsPressedThisFrame) {\n      if (!this.oldMouseButtonsPressed.has(button)) {\n        this.dispatchMouse(button, true);\n      }\n    }\n    for (const button of this.oldMouseButtonsPressed) {\n      if (!this.mouseButtonsPressedThisFrame.has(button)) {\n        this.dispatchMouse(button, false);\n      }\n    }\n\n    if (this.virtualCursor.modified) {\n      this.virtualCursor.modified = false;\n      if (this.virtualCursor.x > this.virtualCursor.maxX) {\n        this.virtualCursor.x = this.virtualCursor.maxX;\n      }\n      if (this.virtualCursor.x < this.virtualCursor.minX) {\n        this.virtualCursor.x = this.virtualCursor.minX;\n      }\n      if (this.virtualCursor.y > this.virtualCursor.maxY) {\n        this.virtualCursor.y = this.virtualCursor.maxY;\n      }\n      if (this.virtualCursor.y < this.virtualCursor.minY) {\n        this.virtualCursor.y = this.virtualCursor.minY;\n      }\n      this.dispatchMouseMove(this.virtualCursor.x, this.virtualCursor.y);\n    }\n  }\n\n  editor() {\n    throw new Error('removed');\n  }\n}\n\nGamepadLib.browserHasBrokenGamepadAPI = () => {\n  // Check that the gamepad API is supported at all\n  if (!navigator.getGamepads) {\n    return true;\n  }\n  // Firefox on Linux has a broken gamepad API implementation that results in strange and sometimes unusable mappings\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1643358\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1643835\n  if (navigator.userAgent.includes(\"Firefox\") && navigator.userAgent.includes(\"Linux\")) {\n    return true;\n  }\n  // Firefox on macOS has other bugs that result in strange and unusable mappings\n  // eg. https://bugzilla.mozilla.org/show_bug.cgi?id=1434408\n  if (navigator.userAgent.includes(\"Firefox\") && navigator.userAgent.includes(\"Mac OS\")) {\n    return true;\n  }\n  return false;\n};\n\nGamepadLib.setConsole = (n) => (console = n);\n\nexport default GamepadLib;\n","import gamepadUserscript from './userscript.js';\nimport gamepadUserstyle from '!raw-loader!./style.css'\n\nconst addStylesheet = (css) => {\n  const stylesheet = document.createElement('style');\n  stylesheet.textContent = css;\n  document.head.appendChild(stylesheet);\n};\n\nconst run = ({ scaffolding, options }) => {\n  gamepadUserscript(scaffolding, options.pointerlock);\n  addStylesheet(gamepadUserstyle);\n};\n\nexport default run;\n","/* inserted by pull.js */\nimport _twAsset0 from \"./active.png\";\nimport _twAsset1 from \"./close.svg\";\nimport _twAsset2 from \"./cursor.png\";\nimport _twAsset3 from \"./dot.svg\";\nconst _twGetAsset = (path) => {\n  if (path === \"/active.png\") return _twAsset0;\n  if (path === \"/close.svg\") return _twAsset1;\n  if (path === \"/cursor.png\") return _twAsset2;\n  if (path === \"/dot.svg\") return _twAsset3;\n  throw new Error(`Unknown asset: ${path}`);\n};\n\nimport GamepadLib from \"./gamepadlib.js\";\n\nexport default async function (scaffolding, pointerlock) {\n  const vm = scaffolding.vm;\n\n  // Wait for the project to finish loading. Renderer and scripts will not be fully available until this happens.\n  await new Promise((resolve) => {\n    if (vm.editingTarget) return resolve();\n    vm.runtime.once(\"PROJECT_LOADED\", resolve);\n  });\n\n  const vmStarted = () => vm.runtime._steppingInterval !== null;\n\n  const scratchKeyToKey = (key) => {\n    switch (key) {\n      case \"right arrow\":\n        return \"ArrowRight\";\n      case \"up arrow\":\n        return \"ArrowUp\";\n      case \"left arrow\":\n        return \"ArrowLeft\";\n      case \"down arrow\":\n        return \"ArrowDown\";\n      case \"enter\":\n        return \"Enter\";\n      case \"space\":\n        return \" \";\n    }\n    return key.toLowerCase().charAt(0);\n  };\n  const getKeysUsedByProject = () => {\n    const allBlocks = [vm.runtime.getTargetForStage(), ...vm.runtime.targets]\n      .filter((i) => i.isOriginal)\n      .map((i) => i.blocks);\n    const result = new Set();\n    for (const blocks of allBlocks) {\n      for (const block of Object.values(blocks._blocks)) {\n        if (block.opcode === \"event_whenkeypressed\" || block.opcode === \"sensing_keyoptions\") {\n          // For blocks like \"key (my variable) pressed?\", the sensing_keyoptions still exists but has a null parent.\n          if (block.opcode === \"sensing_keyoptions\" && !block.parent) {\n            continue;\n          }\n          const key = block.fields.KEY_OPTION.value;\n          result.add(scratchKeyToKey(key));\n        }\n      }\n    }\n    return result;\n  };\n\n  const GAMEPAD_CONFIG_MAGIC = \" // _gamepad_\";\n  const findOptionsComment = () => {\n    const target = vm.runtime.getTargetForStage();\n    const comments = target.comments;\n    for (const comment of Object.values(comments)) {\n      if (comment.text.includes(GAMEPAD_CONFIG_MAGIC)) {\n        return comment;\n      }\n    }\n    return null;\n  };\n  const parseOptionsComment = () => {\n    const comment = findOptionsComment();\n    if (!comment) {\n      return null;\n    }\n    const lineWithMagic = comment.text.split(\"\\n\").find((i) => i.endsWith(GAMEPAD_CONFIG_MAGIC));\n    if (!lineWithMagic) {\n      console.warn(\"Gamepad comment does not contain valid line\");\n      return null;\n    }\n    const jsonText = lineWithMagic.substr(0, lineWithMagic.length - GAMEPAD_CONFIG_MAGIC.length);\n    let parsed;\n    try {\n      parsed = JSON.parse(jsonText);\n      if (!parsed || typeof parsed !== \"object\" || !Array.isArray(parsed.buttons) || !Array.isArray(parsed.axes)) {\n        throw new Error(\"Invalid data\");\n      }\n    } catch (e) {\n      console.warn(\"Gamepad comment has invalid JSON\", e);\n      return null;\n    }\n    return parsed;\n  };\n\n  GamepadLib.setConsole(console);\n  const gamepad = new GamepadLib();\n\n  const parsedOptions = parseOptionsComment();\n  gamepad.getHintsLazily = () => {\n    if (parsedOptions) {\n      return {\n        importedSettings: parsedOptions,\n      };\n    }\n    return {\n      usedKeys: getKeysUsedByProject(),\n    };\n  };\n\n  const renderer = vm.runtime.renderer;\n  const width = renderer._xRight - renderer._xLeft;\n  const height = renderer._yTop - renderer._yBottom;\n  const canvas = renderer.canvas;\n\n  const virtualCursorElement = document.createElement(\"img\");\n  virtualCursorElement.hidden = true;\n  virtualCursorElement.className = \"sa-gamepad-cursor\";\n  virtualCursorElement.src = _twGetAsset(\"/cursor.png\");\n\n  let hideCursorTimeout;\n\n  const hideRealCursor = () => {\n    document.body.classList.add(\"sa-gamepad-hide-cursor\");\n  };\n  const showRealCursor = () => {\n    document.body.classList.remove(\"sa-gamepad-hide-cursor\");\n  };\n  const virtualCursorSetVisible = (visible) => {\n    virtualCursorElement.hidden = !visible;\n    clearTimeout(hideCursorTimeout);\n    if (visible) {\n      hideRealCursor();\n      hideCursorTimeout = setTimeout(virtualCursorHide, 8000);\n    }\n  };\n  const virtualCursorHide = () => {\n    virtualCursorSetVisible(false);\n  };\n  const virtualCursorSetDown = (down) => {\n    virtualCursorSetVisible(true);\n    virtualCursorElement.classList.toggle(\"sa-gamepad-cursor-down\", down);\n  };\n  const virtualCursorSetPosition = (x, y) => {\n    virtualCursorSetVisible(true);\n    const CURSOR_SIZE = 6;\n    const stageX = width / 2 + x - CURSOR_SIZE / 2;\n    const stageY = height / 2 - y - CURSOR_SIZE / 2;\n    virtualCursorElement.style.transform = `translate(${stageX}px, ${stageY}px)`;\n  };\n\n  document.addEventListener(\"mousemove\", () => {\n    virtualCursorSetVisible(false);\n    showRealCursor();\n  });\n\n  let getCanvasSize;\n  // Support modern ResizeObserver and slow getBoundingClientRect version for improved browser support (matters for TurboWarp)\n  if (window.ResizeObserver) {\n    let canvasWidth = width;\n    let canvasHeight = height;\n    const resizeObserver = new ResizeObserver((entries) => {\n      for (const entry of entries) {\n        canvasWidth = entry.contentRect.width;\n        canvasHeight = entry.contentRect.height;\n      }\n    });\n    resizeObserver.observe(canvas);\n    getCanvasSize = () => [canvasWidth, canvasHeight];\n  } else {\n    getCanvasSize = () => {\n      const rect = canvas.getBoundingClientRect();\n      return [rect.width, rect.height];\n    };\n  }\n\n  // Both in Scratch space\n  let virtualX = 0;\n  let virtualY = 0;\n  const postMouseData = (data) => {\n    if (!vmStarted()) return;\n    const [rectWidth, rectHeight] = getCanvasSize();\n    vm.postIOData(\"mouse\", {\n      ...data,\n      canvasWidth: rectWidth,\n      canvasHeight: rectHeight,\n      x: (virtualX + width / 2) * (rectWidth / width),\n      y: (height / 2 - virtualY) * (rectHeight / height),\n    });\n  };\n  const postKeyboardData = (key, isDown) => {\n    if (!vmStarted()) return;\n    vm.postIOData(\"keyboard\", {\n      key,\n      isDown,\n    });\n  };\n  const handleGamepadButtonDown = (e) => postKeyboardData(e.detail, true);\n  const handleGamepadButtonUp = (e) => postKeyboardData(e.detail, false);\n  const handleGamepadMouseDown = (e) => {\n    virtualCursorSetDown(true);\n    postMouseData({\n      isDown: true,\n      button: e.detail,\n    });\n  };\n  const handleGamepadMouseUp = (e) => {\n    virtualCursorSetDown(false);\n    postMouseData({\n      isDown: false,\n      button: e.detail,\n    });\n  };\n  const handleGamepadMouseMove = (e) => {\n    const {x, y} = e.detail;\n    if (pointerlock) {\n      const deltaX = x - virtualX;\n      const deltaY = -(y - virtualY);\n      virtualX = x;\n      virtualY = y;\n      // Coordinates that pointerlock accepts are in \"screen space\" but virtual cursor is in \"stage space\"\n      const SPEED_MULTIPLIER = 4.0;\n      const zoomMultiplierX = scaffolding.layersRect.width / vm.runtime.stageWidth;\n      const zoomMultiplierY = scaffolding.layersRect.height / vm.runtime.stageHeight;\n      // This is defined in pointerlock addon\n      vm.pointerLockMove(\n        deltaX * SPEED_MULTIPLIER * zoomMultiplierX,\n        deltaY * SPEED_MULTIPLIER * zoomMultiplierY\n      );\n    } else {\n      virtualX = x;\n      virtualY = y;\n      virtualCursorSetPosition(virtualX, virtualY);\n      postMouseData({});\n    }\n  };\n\n  if (!pointerlock) {\n    gamepad.virtualCursor.maxX = renderer._xRight;\n    gamepad.virtualCursor.minX = renderer._xLeft;\n    gamepad.virtualCursor.maxY = renderer._yTop;\n    gamepad.virtualCursor.minY = renderer._yBottom;\n  }\n\n  gamepad.addEventListener(\"keydown\", handleGamepadButtonDown);\n  gamepad.addEventListener(\"keyup\", handleGamepadButtonUp);\n  gamepad.addEventListener(\"mousedown\", handleGamepadMouseDown);\n  gamepad.addEventListener(\"mouseup\", handleGamepadMouseUp);\n  gamepad.addEventListener(\"mousemove\", handleGamepadMouseMove);\n\n  if (!pointerlock) {\n    scaffolding._overlays.appendChild(virtualCursorElement);\n  }\n}\n","import gamepad from './gamepad';\nimport pointerlock from './pointerlock';\nimport specialCloudBehaviors from './special-cloud-behaviors';\nimport unsafeCloudBehaviors from './unsafe-cloud-behaviors';\nimport pause from './pause';\n\nconst run = (scaffolding, options) => {\n  const api = {\n    scaffolding,\n    options\n  };\n\n  if (options.gamepad) gamepad(api);\n  if (options.pointerlock) pointerlock(api);\n  if (options.specialCloudBehaviors) specialCloudBehaviors(api);\n  if (options.unsafeCloudBehaviors) unsafeCloudBehaviors(api);\n  if (options.pause) pause(api);\n};\n\nwindow.ScaffoldingAddons = {\n  run\n};\n","export default function ({ scaffolding }) {\n  // This file is based on the `pause` addon from Scratch Addons\n  // All major portions of this file were written by me, so the GPL does not apply\n\n  const STATUS_PROMISE_WAIT = 1;\n  const STATUS_DONE = 4;\n\n  const vm = scaffolding.vm;\n\n  let paused = false;\n  let pausedThreadState = new WeakMap();\n\n  let audioContextStateChange = Promise.resolve();\n\n  const setPaused = (_paused) => {\n    paused = _paused;\n\n    if (paused) {\n      audioContextStateChange = audioContextStateChange.then(() => {\n        return vm.runtime.audioEngine.audioContext.suspend();\n      });\n      if (!vm.runtime.ioDevices.clock._paused) {\n        vm.runtime.ioDevices.clock.pause();\n      }\n\n      for (const thread of vm.runtime.threads) {\n        if (!thread.updateMonitor && !pausedThreadState.has(thread)) {\n          const pauseState = {\n            pauseTime: vm.runtime.currentMSecs,\n            status: thread.status,\n          };\n          pausedThreadState.set(thread, pauseState);\n          thread.status = STATUS_PROMISE_WAIT;\n        }\n      }\n\n      // Immediately emit project stop\n      // Scratch will do this automatically, but there may be a slight delay.\n      vm.runtime.emit(\"PROJECT_RUN_STOP\");\n    } else {\n      audioContextStateChange = audioContextStateChange.then(() => {\n        return vm.runtime.audioEngine.audioContext.resume();\n      });\n      vm.runtime.ioDevices.clock.resume();\n\n      const now = Date.now();\n      for (const thread of vm.runtime.threads) {\n        const pauseState = pausedThreadState.get(thread);\n        if (pauseState) {\n          const stackFrame = thread.peekStackFrame();\n          if (stackFrame && stackFrame.executionContext && stackFrame.executionContext.timer) {\n            const dt = now - pauseState.pauseTime;\n            stackFrame.executionContext.timer.startTime += dt;\n          }\n          // Compiler state is stored differently\n          if (thread.timer) {\n            const dt = now - pauseState.pauseTime;\n            thread.timer.startTime += dt;\n          }\n          thread.status = pauseState.status;\n        }\n      }\n      pausedThreadState = new WeakMap();\n    }\n\n    vm.emit('P4_PAUSE', paused);\n  };\n\n  const ensurePausedThreadIsStillPaused = (thread) => {\n    if (thread.status === STATUS_DONE) {\n      return;\n    }\n    const pauseState = pausedThreadState.get(thread);\n    if (pauseState) {\n      if (thread.status !== STATUS_PROMISE_WAIT) {\n        // We'll record the change so we can properly resume the thread, but the thread must still be paused for now.\n        pauseState.status = thread.status;\n        thread.status = STATUS_PROMISE_WAIT;\n      }\n    }\n  };\n\n  const originalStepThreads = vm.runtime.sequencer.stepThreads;\n  vm.runtime.sequencer.stepThreads = function () {\n    if (paused) {\n      for (const thread of this.runtime.threads) {\n        ensurePausedThreadIsStillPaused(thread);\n      }\n    }\n    return originalStepThreads.call(this);\n  };\n\n  const originalGreenFlag = vm.runtime.greenFlag;\n  vm.runtime.greenFlag = function () {\n    setPaused(false);\n    return originalGreenFlag.call(this);\n  };\n\n  // Disable edge-activated hats and hats like \"when key pressed\" while paused.\n  const originalStartHats = vm.runtime.startHats;\n  vm.runtime.startHats = function (...args) {\n    if (paused) {\n      return [];\n    }\n    return originalStartHats.apply(this, args);\n  };\n\n  // Paused threads should not be counted as running when updating GUI state.\n  const originalGetMonitorThreadCount = vm.runtime._getMonitorThreadCount;\n  vm.runtime._getMonitorThreadCount = function (threads) {\n    let count = originalGetMonitorThreadCount.call(this, threads);\n    if (paused) {\n      for (const thread of threads) {\n        if (pausedThreadState.has(thread)) {\n          count++;\n        }\n      }\n    }\n    return count;\n  };\n\n  vm.setPaused = setPaused;\n}","const run = ({ scaffolding }) => {\n  const canvas = scaffolding._canvas;\n  const vm = scaffolding.vm;\n  const mouse = vm.runtime.ioDevices.mouse;\n  let isLocked = false;\n\n  const postMouseData = (e, isDown) => {\n    const {movementX, movementY} = e;\n    const {width, height} = scaffolding.layersRect;\n    const x = mouse._clientX + movementX;\n    const y = mouse._clientY - movementY;\n    mouse._clientX = x;\n    mouse._scratchX = mouse.runtime.stageWidth * ((x / width) - 0.5);\n    mouse._clientY = y;\n    mouse._scratchY = mouse.runtime.stageWidth * ((y / height) - 0.5);\n    if (typeof isDown === 'boolean') {\n      const data = {\n        button: e.button,\n        isDown\n      };\n      vm.postIOData('mouse', data);\n    }\n  };\n  document.addEventListener(\"mousedown\", (e) => {\n    if (canvas.contains(e.target)) {\n      e.stopPropagation();\n      if (isLocked) {\n        postMouseData(e, true);\n      } else {\n        canvas.requestPointerLock();\n      }\n    }\n  }, true);\n  document.addEventListener(\"mouseup\", (e) => {\n    e.stopPropagation();\n    if (isLocked) {\n      postMouseData(e, false);\n    } else if (canvas.contains(e.target)) {\n      canvas.requestPointerLock();\n    }\n  }, true);\n  document.addEventListener(\"mousemove\", (e) => {\n    e.stopPropagation();\n    if (isLocked) {\n      postMouseData(e);\n    }\n  }, true);\n\n  scaffolding.addEventListener('PROJECT_RUN_START', () => {\n    if (!isLocked) {\n      canvas.requestPointerLock();\n    }\n  });\n\n  document.addEventListener('pointerlockchange', () => {\n    isLocked = document.pointerLockElement === canvas;\n  });\n  document.addEventListener('pointerlockerror', (e) => {\n    console.error('Pointer lock error', e);\n  });\n\n  vm.pointerLockMove = (deltaX, deltaY) => {\n    postMouseData({\n      // Essentially constructing a fake MouseEvent\n      movementX: deltaX,\n      movementY: deltaY\n    });\n  };\n\n  const oldStep = vm.runtime._step;\n  vm.runtime._step = function (...args) {\n    const ret = oldStep.call(this, ...args);\n    const {width, height} = scaffolding.layersRect;\n    mouse._clientX = width / 2;\n    mouse._clientY = height / 2;\n    mouse._scratchX = 0;\n    mouse._scratchY = 0;\n    return ret;\n  };\n};\n\nexport default run;\n","const SAFE_PROTOCOLS = [\n  // The only protocol that's critical to block is javascript:\n  // file: is indeed unsafe in places like Electron, but it's the Electron environment's job to protect against that\n  // Navigating between file: is safe on the web\n  'http:',\n  'https:',\n  'data:',\n  'file:',\n  'mailto:',\n];\n\nconst isSafeURL = (url) => {\n  try {\n    const u = new URL(url, location.href);\n    return SAFE_PROTOCOLS.includes(u.protocol);\n  } catch (e) {\n    return false;\n  }\n};\n\nconst shouldAlwaysOpenInNewTab = (url) => {\n  try {\n    const u = new URL(url, location.href);\n    // Browsers don't allow opening new tabs with data: URIs\n    return u.protocol === 'data:';\n  } catch (e) {\n    return false;\n  }\n};\n\nconst shouldAlwaysOpenInCurrentTab = (url) => {\n  try {\n    const u = new URL(url, location.href);\n    // If you open a mailto: in a new tab, the browser will convert it to about:blank and just leave an empty tab\n    return u.protocol === 'mailto:';\n  } catch (e) {\n    return false;\n  }\n};\n\nconst openInNewTab = (url) => {\n  window.open(url);\n};\n\nconst openInCurrentTab = (url) => {\n  location.href = url;\n};\n\nclass SpecialCloudBehaviorsProvider {\n  enable () {\n    this.manager.setVariable(this, ' url', location.href);\n\n    document.addEventListener('paste', (e) => {\n      const text = (e.clipboardData || window.clipboardData).getData('text');\n      this.manager.setVariable(this, ' pasted', text);\n    });\n\n    this.webSocketProvider = this.manager.providers.find(i => typeof i.setProjectId === 'function');\n    this.initialProjectId = this.webSocketProvider ? this.webSocketProvider.projectId : null;\n  }\n\n  handleUpdateVariable (name, value) {\n    if (name === ' redirect') {\n      if (isSafeURL(value)) {\n        if (shouldAlwaysOpenInNewTab(value)) {\n          openInNewTab(value);\n        } else {\n          openInCurrentTab(value);\n        }\n      }\n    } else if (name === ' open link') {\n      if (isSafeURL(value)) {\n        if (shouldAlwaysOpenInCurrentTab(value)) {\n          openInCurrentTab(value);\n        } else {\n          openInNewTab(value);\n        }\n      }\n    } else if (name === ' username') {\n      this.manager.parent.setUsername(value);\n    } else if (name === ' set clipboard') {\n      navigator.clipboard.writeText(value);\n    } else if (name === ' room id') {\n      if (this.webSocketProvider) {\n        const newId = this.initialProjectId + (value ? `-${value}` : '');\n        this.webSocketProvider.setProjectId(newId);\n      }\n    }\n  }\n}\n\nexport default function ({ scaffolding }) {\n  const provider = new SpecialCloudBehaviorsProvider();\n  scaffolding.addCloudProvider(provider);\n  scaffolding.addCloudProviderOverride(' url', provider);\n  scaffolding.addCloudProviderOverride(' redirect', provider);\n  scaffolding.addCloudProviderOverride(' open link', provider);\n  scaffolding.addCloudProviderOverride(' username', provider);\n  scaffolding.addCloudProviderOverride(' set clipboard', provider);\n  scaffolding.addCloudProviderOverride(' pasted', provider);\n  scaffolding.addCloudProviderOverride(' room id', provider);\n}\n","const isPromise = (v) => !!v && typeof v.then === 'function';\n\nconst jsValueToScratchValue = (v) => {\n  if (typeof v === 'boolean' || typeof v === 'number' || typeof v === 'string') {\n    return v;\n  }\n  return '' + v;\n};\n\nclass UnsafeCloudBehaviorsProvider {\n  enable () {\n\n  }\n\n  setEvalValue (value) {\n    this.manager.setVariable(this, ' eval output', jsValueToScratchValue(value));\n  }\n\n  setEvalError (error) {\n    console.error('Error evaluating  eval', error);\n    this.manager.setVariable(this, ' eval error', jsValueToScratchValue(error));\n  }\n\n  evaluateAsync (js) {\n    try {\n      const value = eval(js);\n      if (isPromise(value)) {\n        value\n          .then((v) => this.setEvalValue(v))\n          .catch((e) => this.setEvalError(e));\n      } else {\n        this.setEvalValue(value)\n      }\n    } catch (e) {\n      this.setEvalError(e);\n    }\n  }\n\n  handleUpdateVariable (name, value) {\n    if (name === ' eval') {\n      this.evaluateAsync(value);\n    }\n  }\n}\n\nexport default function ({ scaffolding }) {\n  const provider = new UnsafeCloudBehaviorsProvider();\n  scaffolding.addCloudProvider(provider);\n  scaffolding.addCloudProviderOverride(' eval', provider);\n  scaffolding.addCloudProviderOverride(' eval output', provider);\n  scaffolding.addCloudProviderOverride(' eval error', provider);\n}\n","// Browser support for EventTarget constructor is surprisingly poor, so we always polyfill it\n// We also need to polyfill CustomEvent for Node.js\n\nclass EventTargetShim {\n  constructor () {\n    this._events = {};\n  }\n\n  addEventListener (event, handler) {\n    if (!this._events[event]) {\n      this._events[event] = [];\n    }\n    this._events[event].push(handler);\n  }\n\n  removeEventListener (event, handler) {\n    const handlers = this._events[event];\n    if (handlers) {\n      this._events[event] = handlers.filter(i => i !== handler);\n    }\n  }\n\n  dispatchEvent (event) {\n    const handlers = this._events[event.type];\n    if (handlers) {\n      for (const fn of handlers) {\n        fn(event);\n      }\n    }\n  }\n}\n\nclass CustomEventShim {\n  constructor (type, options) {\n    this.type = type;\n    this.detail = options ? options.detail : {};\n  }\n}\n\nexport {\n  EventTargetShim as EventTarget,\n  CustomEventShim as CustomEvent\n};\n"],"sourceRoot":""}